<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
	
	<ui:composition template="/templates/_template.xhtml">
	
		<ui:define name="additional-content">
			<link type="text/css" rel="stylesheet" href="/resources/css/user.css" media="screen,projection" />
	   	</ui:define>
	   	
	   	<div id="navbar">
			<ui:define name="nav-expanded">
		      	<ui:include src="/templates/_about-nav.xhtml" />
			</ui:define>
			<ui:define name="nav-collapsed">
		      	<ui:include src="/templates/_about-nav.xhtml" />
			</ui:define>
		</div>
	
		<ui:define name="content">
			<f:metadata>
    			<f:viewAction action="#{passwordConfirmResetBean.token}" />
			</f:metadata>
			
			<div class="container">
			
				<div class="row justify-content-center mt-3">
					<h:messages globalOnly="true" class="text-danger text-center" layout="table"/>
					
					<h:form rendered="#{passwordConfirmResetBean.changePasswordFormRender}" class="col-10 col-sm-10 col-md-10 col-xl-7">
							
						<legend class="fs-3 fs-sm-2 text-center">Insert your new password</legend>
						
						<div class="row row-cols-2">
							<div class="col-12 col-md-12 col-lg-3">
								<h:outputLabel value="Username:" for="username"/>
							</div>
							<div class="col-12 col-md-12 col-lg-9 mt-1">
								<div class="input-group">
								  	<span class="input-group-text" id="username-addon"><i class="fas fa-user-circle"></i></span>
									<h:inputText id="username" class="form-control shadow" value="#{passwordConfirmResetBean.user.username}" disabled="true">
										<f:passThroughAttribute name="aria-describedby" value="username-addon"/>
									</h:inputText>
								</div>
							</div>
							
							<div class="col-12 col-md-12 col-lg-3">
								<h:outputLabel value="Email:" for="email"/>
							</div>
							<div class="col-12 col-md-12 col-lg-9 mt-1">
								<div class="input-group">
									<span class="input-group-text" id="email-addon"><i class="fas fa-envelope"></i></span>
									<h:inputText id="email" class="form-control shadow" value="#{passwordConfirmResetBean.user.email}" disabled="true">
										<f:passThroughAttribute name="aria-describedby" value="email-addon"/>
									</h:inputText>
								</div>
							</div>
							
							<div class="col-12 col-md-12 col-lg-3 mt-2">
								<h:outputLabel value="New password" for="password"/>
							</div>	
							<div class="col-12 col-md-12 col-lg-9 mt-1">
								<div class="input-group">
									<span class="input-group-text" id="password-addon"><i class="fas fa-unlock"></i></span>
									<h:inputSecret id="password" class="form-control shadow" value="#{passwordConfirmResetBean.newPassword}" binding="#{passwordComponent}" required="true" requiredMessage="You must insert a password"
									validatorMessage="Password must contain between 6 and 30 characters">
										<f:validateLength maximum="30" minimum="6"/>
										<f:passThroughAttribute name="placeholder" value="Insert your new password"/>
										<f:passThroughAttribute name="aria-describedby" value="password-addon"/>
									</h:inputSecret>
								</div>
							</div>
							<h:message class="col-12 text-center text-danger" for="password"/>
							
							<div class="col-12 col-md-12 col-lg-3 mt-2">
								<h:outputLabel value="Confirm new password" for="confirmPassword"/>
							</div>
							<div class="col-12 col-md-12 col-lg-9 mt-1">
								<div class="input-group">
									<span class="input-group-text" id="password-confirm-addon"><i class="fas fa-unlock-alt"></i></span>
									<h:inputSecret id="confirmPassword" class="form-control shadow" required="true" requiredMessage="You must confirm your password">
										<f:validator validatorId="equalsValidator" />
										<f:attribute name="passwordEmail" value="#{passwordComponent.value}"/>
										<f:passThroughAttribute name="placeholder" value="Confirm your new password"/>
										<f:passThroughAttribute name="aria-describedby" value="password-confirm-addon"/>
									</h:inputSecret>
								</div>
							</div>
							<h:message class="col-12 text-center text-danger" for="confirmPassword"/>
							
							<div class="col-12 col-sm-12 mx-auto mt-4">
								<h:commandButton value="Alter password" class="col-12 btn shadow" action="#{passwordConfirmResetBean.reset}">
									<f:passThroughAttribute name="id" value="confirm-button"/>
								</h:commandButton>
							</div>
						</div>
					</h:form>
				</div>
			</div>
			
		</ui:define>
	</ui:composition>
</html>