<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

	<ui:composition template="/templates/_template.xhtml">
		
		<ui:define name="additional-content">
			<link type="text/css" rel="stylesheet" href="/resources/css/english.css" media="screen,projection" />
    	</ui:define>
	
		<div id="navbar">
			<ui:define name="nav-expanded">
		      	<ui:include src="/templates/_averages-nav.xhtml" />
			</ui:define>
			<ui:define name="nav-collapsed">
		      	<ui:include src="/templates/_averages-nav.xhtml" />
			</ui:define>
		</div>
		
		<ui:define name="content">
			<div class="container">
				<div class="row justify-content-center mt-3">
					<h:messages layout="table"/>
						
						<div class="col-12 col-lg-10">
							<span><i class="fas fa-user"></i>&nbsp;&nbsp;#{averagesBean.user.username}</span><br></br>
							<span><i class="fas fa-at"></i>&nbsp;&nbsp;#{averagesBean.user.email}</span>
						</div>
						<div class="col-12 col-lg-10">
							<hr/>
						</div>
						<div class="col-12 col-lg-10 d-none d-md-block">
					        <h:dataTable var="average" class="mx-auto table table-sm" value="#{averagesBean.averages}">
					            <h:column class="col-5" headerText="Subject">
					            	<f:facet name="header"><span class="fs-5">Subject</span></f:facet>
					                <h:outputText value="#{average.subject}"/>
					            </h:column>
					            <h:column class="col-3" headerText="Level">
					            	<f:facet name="header"><span class="fs-5">Level</span></f:facet>
					                <h:outputText value="#{average.levelCapitalize}"/>
					            </h:column>
					            <h:column class="col-3" headerText="Average">
					            	<f:facet name="header"><span class="fs-5">Average</span></f:facet>
					                <div class="progress" style="height: 1.9em;">
				  						<div class="progress-bar #{average.bootstrapColor}" role="progressbar" style="width: #{average.averageForMeter}%" aria-valuenow="#{average.averageForMeter}" aria-valuemin="0" aria-valuemax="100"><span style="font-size: 1.2em; font-weight: bold;">#{average.averageForMeter}%</span></div>
									</div>
					            </h:column>
					        </h:dataTable>
				        </div>
				        <div class="col-12 col-lg-10 d-block d-md-none">
				        	<ui:repeat var="average" value="#{averagesBean.averages}">
					        	<div class="card mb-1 bg-light border-secondary shadow" style="height: 6.8em;">
					        		<div class="card-header">
									    #{average.subject}
									</div>
									<div class="card-body">
									<h6 class="card-subtitle mb-1 text-muted">Level: #{average.levelCapitalize}</h6>
										<div class="d-inline-block">Average:&nbsp;</div>
										<div id="progress-bar" class="d-inline-block">
											<div class="progress">
												<div class="progress-bar #{average.bootstrapColor}" role="progressbar" style="width: #{average.averageForMeter}%" aria-valuenow="#{average.averageForMeter}" aria-valuemin="0" aria-valuemax="100">#{average.averageForMeter}%</div>
											</div>
										</div>
									</div>
								</div>
							</ui:repeat>
				        </div>
					
					<button type="button" class="col-8 col-sm-6 btn btn-danger shadow mt-4 mb-4" data-bs-toggle="modal" data-bs-target="#firstDeleteUserModal">
		  				Delete my account
					</button>
				</div>
				
				<div class="modal fade" id="firstDeleteUserModal" tabindex="-1" aria-labelledby="firstDeleteUserModalLabel" aria-hidden="true">
				  	<div class="modal-dialog modal-dialog-centered">
					    <div class="modal-content">
						    <div class="modal-header">
						        <h5 class="modal-title" id="firstDeleteUserModalLabel">Delete My Account</h5>
						        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
						    </div>
						    <div class="modal-body">
					        	Are you sure you want to delete your account?
							</div>
						    <div class="modal-footer">
						        <button type="button" class="btn btn-success" data-bs-dismiss="modal">Close</button>
								<button type="button" class="btn btn-warning" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#finalDeleteUserModal">
	  								Delete my account
								</button>
						    </div>
					    </div>
					</div>
				</div>
				
				<div class="modal fade" id="finalDeleteUserModal" tabindex="-1" aria-labelledby="finalDeleteUserModalLabel" aria-hidden="true">
				  	<div class="modal-dialog modal-dialog-centered">
					    <div class="modal-content">
						    <div class="modal-header">
						        <h5 class="modal-title" id="finalDeleteUserModalLabel">Delete My Account</h5>
						        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
						    </div>
						    <div class="modal-body">
					        	Warning! If you delete your account now, all your data will be lost!
							</div>
						    <div class="modal-footer">
						        <button type="button" class="btn btn-success" data-bs-dismiss="modal">No, don't delete my account!</button>
							    <h:form>
							    	<h:commandButton styleClass="btn btn-danger" value="Please, I really want to delete my account!" action="#{userDeleteBean.delete}"/>
							    </h:form>
						    </div>
					    </div>
					</div>
				</div>
			</div>
		</ui:define>
		
		<ui:define name="footer">
			<div class="d-none d-sm-block">
				<ui:include src="/templates/_footer.xhtml" />
			</div>
		</ui:define>

	</ui:composition>

</html>