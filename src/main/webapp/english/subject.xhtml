<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
xmlns:p="http://primefaces.org/ui">

	<ui:composition template="/templates/_template.xhtml">
		
		<div id="navbar">
			<ui:define name="nav-expanded">
		      	<ui:include src="/templates/_home-nav.xhtml" />
			</ui:define>
			<ui:define name="nav-collapsed">
		      	<ui:include src="/templates/_home-nav.xhtml" />
			</ui:define>
		</div>
		
		<ui:define name="content">
			<div class="container">
			<p:growl id="growl" showDetail="true" skipDetailIfEqualsSummary="true"/>
				<h:form id="subjectForm">
				
				<ui:include src="/templates/_subjects-menu.xhtml"></ui:include>
					
					<div class="row justify-content-center mt-2">
						<div class="col-12">
							<div class="input-group mt-1">
							  	<span class="input-group-text" id="username-addon"><i class="fas fa-book"></i></span>
	   							<p:inputText id="subject-title-addon" styleClass="form-control shadow" value="#{subjectBean.subject.title}" required="true" requiredMessage="Insert a subject title.">
	   								<f:passThroughAttribute name="type" value="text"/>
									<f:passThroughAttribute name="placeholder" value="Subject title"/>
									<f:passThroughAttribute name="aria-describedby" value="subject-title-addon"/>
	   							</p:inputText>
	   						</div>
						</div>
					</div>
					
					<ui:repeat var="task" value="#{subjectBean.subject.tasks}" varStatus="status">
						<p:divider />
						<div class="row justify-content-center mb-2">
							<div class="col-10">
								<div class="input-group mt-1">
								  	<span class="input-group-text" id="username-addon"><i class="fas fa-question-circle"></i></span>
									<p:inputText id="username" styleClass="form-control shadow" value="#{task.prompt}"> 
										<f:passThroughAttribute name="type" value="text"/>
										<f:passThroughAttribute name="placeholder" value="Question"/>
										<f:passThroughAttribute name="aria-describedby" value="username-addon"/>
									</p:inputText>
								</div>
							</div>
						</div>
						<h:panelGroup id="options">
							<div class="row justify-content-center">
								<div class="col-9">
									<ui:repeat var="option" value="#{task.options}" varStatus="optionStatus" >
										<div class="input-group mt-1">
										  	<span class="input-group-text" id="username-addon"><i class="fas fa-arrow-circle-right"></i></span>
											<p:inputText id="username" styleClass="form-control shadow" value="#{option.prompt}"> 
												<f:passThroughAttribute name="type" value="text"/>
												<f:passThroughAttribute name="placeholder" value="Option #{optionStatus.index + 1}"/>
												<f:passThroughAttribute name="aria-describedby" value="username-addon"/>
											</p:inputText>
											<p:selectBooleanButton value="#{option.correct}" onIcon="pi pi-check" offIcon="pi pi-times" title="Is this option correct?" />
										</div>
									</ui:repeat>
									
									<div class="mt-2">
										<p:commandButton actionListener="#{subjectBean.addOption(status.index)}" update="growl options" icon="pi pi-plus" styleClass="rounded-button shadow" />
										<p:commandButton actionListener="#{subjectBean.removeOption(status.index)}" update="growl options" icon="pi pi-minus" styleClass="rounded-button ui-button-danger shadow" style="margin-left: .5em;"/>
									</div>
								</div>
							</div>
						</h:panelGroup>
					</ui:repeat>
					<p:divider />
					<div class="row justify-content-center mt-2">
						<p:commandButton actionListener="#{subjectBean.addTask}" value="Add task" process="@form" update="@form growl" styleClass="col-3 rounded-button shadow" />
						<p:commandButton actionListener="#{subjectBean.removeTask}" value="Remove task" process="@form" update="@form growl" styleClass="col-3 ms-1 rounded-button ui-button-danger shadow"/>
					</div>
					<div class="row justify-content-center mt-3 mb-3">
						<p:commandButton actionListener="#{subjectBean.saveSubject}" process="@form" update="growl @form" value="Save subject" styleClass="col-6 mt-1 rounded-button ui-button-success shadow" />
					</div>
				</h:form>
				
			</div>
		</ui:define>
		
		<ui:define name="footer">
			<div class="d-none d-sm-block">
				<ui:include src="/templates/_footer.xhtml" />
			</div>
		</ui:define>

	</ui:composition>

</html>